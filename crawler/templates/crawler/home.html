{% extends "crawler/customuser.html" %}
{% block content %}
{% load staticfiles %}

{% if user.is_authenticated and user.username %}

        <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3" style="text-align: center">
                <img src='{% static "crawler/media/exaro.png" %}' style="margin-top: 20px"/>
            </div>
             <form class="col-md-6 col-md-offset-3" method=get>
                <div class="input-group">
                    <br/>
                    <br/>
                    <br/>
                    <input type="text" autocomplete="off" class="form-control" list="suggest" id="searchtext" name="query" value="{{query}}" />
                    <datalist id="suggest">
                    </datalist>
			<span class="input-group-btn">
                            <br/>
                            <br/>
                            <br/>
                             <button class="btn btn-default" type="submit">
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                    </span>

                </div>
		<script>
                    console.log("Hi");
                    var bar=document.getElementById("searchtext");
                    bar.oninput = function() {myFunction()};

                    function myFunction() {
                        //alert("The value of the input field was changed.");
                        console.log(bar.value);
                        var url = "/get_suggestion?query="+bar.value;

                        var jsonFile = new XMLHttpRequest();
                        jsonFile.open("GET",url,true);
                        jsonFile.send();

                        jsonFile.onreadystatechange = function() {
                            if (jsonFile.readyState== 4 && jsonFile.status == 200) {
                                //console.log(jsonFile.responseText);
                                var resp=JSON.parse(jsonFile.responseText);
                                var options = '';
                                console.log(resp[1]);
                                for(var i = 0; i < resp[1].length; i++)
                                    options += '<option value="'+resp[1][i]+'" />';
                                document.getElementById('suggest').innerHTML = options;
                            }
                         }
                    }
                </script>
                <br/>
                <div class="container " style="text-align:center;">
                    <select name="theme" class="selectpicker " data-style="btn-info">
                        <option value="all">All Themes</option>
                        <option value="tech">Technology</option>
                        <option value="business">Business</option>
                        <option value="energy">Energy</option>
			 <option value="agri">Agriculture</option>
                        <option value="water">Water</option>
                        <option value="people">People</option>
                        <option value="ent">Entertainment</option>

                    </select>
   		 
                </div>

            </form>
            </div>
        </div>
    </div>
     <div align="center" id="google_translate_element"></div>

            <script type="text/javascript">
            function googleTranslateElementInit() {
              new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
            }
            </script>
            <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit">
            </script>
    <div class="container " style="margin-top:30px; text-align: center;">
         <hr/>
            <p>&copy;  Powered by    
             <img src='{% static "crawler/media/cortexlogiclogo.jpg" %}' width="200"  height ="80"/></p>
    </div>

      <div class="table-hover" style="margin-top: 30px">
                {% for row in feed.articles %}
                    <div class="col-md-4 col-xs-12 scard pull-right">
                        <div class="rowarticle" onclick="window.location.href='{{row.url}}';">
                              <div class="card small">
                                <div class="card-image">
                                  <img src="{{row.image}}">
                                </div>
                                <div class="card-content">
                               <div class="category definition"  style="padding: 3px 7px !important;font-size: 13px !important;
                        background-color: #0007ff;font-weight: bold;text-shadow: 1px 1px black;color: #ffffff;border-radius: 5px;-moz-border-radius: 5px;-webkit-border-radius: 5px;border: 1px solid black;cursor: pointer;
                        box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset;-moz-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset;
                        -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) inset;"> <p><b> {{row.Category}}</b></p></div>
                        
         
				 <p ><b>{{row.title}}</b></p>
                                </div>
                                
                              </div>
                         </div>
                        <br/>
                    </div> 
                 
                {% endfor %}
            
    </div>

    <br/>
    {% else %}
        <p>Welcome anonymous user!
            You need to <a href="/login/">login</a></p>
    {% endif %}


{% endblock %}


